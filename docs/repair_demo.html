<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>UNNS Stability Repair Demo</title>
<style>
  body { background:#0b0c1a; color:#eee; font-family:Arial, sans-serif; text-align:center; }
  canvas { background:#111; border:1px solid #555; margin:20px; }
  .btn-row { margin:10px 0; }
  button { 
    margin:5px; padding:10px 15px; border:none; border-radius:6px; 
    cursor:pointer; font-size:14px; background:#eee; color:#000;
  }
  button:hover { background:#444; color:#fff; }
  a.code-link {
    color:#66ccff; margin-left:8px; font-size:14px; text-decoration:none;
  }
  a.code-link:hover { text-decoration:underline; }
</style>
</head>
<body>
  <h2>ðŸ”§ UNNS Stability Repair Demo</h2>
  <canvas id="repairCanvas" width="600" height="300"></canvas>

  <div class="btn-row">
    <button onclick="applyProofreading()">Proofreading</button>
    <a href="https://ukbbi.github.io/UNNS/experiments/repairs/demo_repair.py" target="_blank" class="code-link">[code]</a>
  </div>

  <div class="btn-row">
    <button onclick="applyExcision()">Excision + Refit</button>
    <a href="https://ukbbi.github.io/UNNS/experiments/repairs/diagnostics.py" target="_blank" class="code-link">[code]</a>
  </div>

  <div class="btn-row">
    <button onclick="applyRenorm()">Global Renormalization</button>
    <a href="https://ukbbi.github.io/UNNS/experiments/repairs/repair_operators.py" target="_blank" class="code-link">[code]</a>
  </div>

<script>
let ctx = document.getElementById("repairCanvas").getContext("2d");
let seq = [];
let originalSeq = [];
let coeffs = [1,1];

// --- Initialize Fibonacci with corruption ---
function initSeq(n=40){
  seq = [0,1];
  for(let i=2;i<n;i++) seq.push(seq[i-1]+seq[i-2]);
  seq[20]+=50; // corruption
  originalSeq = [...seq]; // save baseline
}

// --- Draw sequence (original red, repaired cyan) ---
function drawSeq(){
  ctx.clearRect(0,0,600,300);

  // Original corrupted in red
  ctx.beginPath();
  ctx.strokeStyle="red";
  originalSeq.forEach((v,i)=>{
    let x = 10+i*14, y = 150 - v*0.5;
    if(i===0) ctx.moveTo(x,y); else ctx.lineTo(x,y);
  });
  ctx.stroke();

  // Current repaired in cyan
  ctx.beginPath();
  ctx.strokeStyle="#66ccff";
  seq.forEach((v,i)=>{
    let x = 10+i*14, y = 150 - v*0.5;
    if(i===0) ctx.moveTo(x,y); else ctx.lineTo(x,y);
  });
  ctx.stroke();
}

// --- Repair Rules ---
window.applyProofreading = function(){
  for(let i=2;i<seq.length;i++){
    let pred = coeffs[0]*seq[i-1] + coeffs[1]*seq[i-2];
    seq[i] = 0.2*seq[i] + 0.8*pred;
  }
  drawSeq();
};

window.applyExcision = function(){
  for(let i=15;i<25;i++){
    let pred = coeffs[0]*seq[i-1] + coeffs[1]*seq[i-2];
    seq[i]=pred;
  }
  drawSeq();
};

window.applyRenorm = function(){
  let norm = Math.sqrt(seq.reduce((s,v)=>s+v*v,0)/seq.length);
  seq = seq.map(v=>v/norm);
  drawSeq();
};

// --- Init and Draw ---
initSeq();
drawSeq();
</script>
</body>
</html>

